# Genomic analysis using foundational transformer models

This repository contains the source code and Jupyter notebooks for analyzing genomic sequences from the [DHS dataset](https://www.meuleman.org/research/synthseqs/) using transformer models. The project includes scripts for fine-tunin the [Nucleotide Transformer model](https://github.com/instadeepai/nucleotide-transformer) on the DHS dataset.

## Table of Contents

- [Introduction](#introduction)
- [Installation](#installation)
- [Usage](#usage)
- [Repository Structure](#repository-structure)
- [Dependencies](#dependencies)
- [Setup Instructions](#setup-instructions)
- [Running the Notebooks](#running-the-notebooks)
- [License](#license)

## Introduction

This project leverages transformer models to analyze genomic sequences. It includes filtering and preprocessing the dataset, extracting attention weights, and visualizing the results. The key visualizations include heatmaps of token importance and word clouds of prominent sequence tokens.

## Installation

Clone the repository to your local machine using:
```bash
git clone https://github.com/your-username/your-repo-name.git
cd your-repo-name
```

## Usage

This repository includes several Jupyter notebooks for different stages of the genomic analysis pipeline. Each notebook is documented with comments to guide you through the steps.

## Repository Structure

```
your-repo-name/
├── checkpoints/
│   └── (model checkpoints and other related files)
├── figs/
│   └── (figures and visualizations)
├── supplm-analysis.ipynb
├── filter_master.ipynb
├── main_analysis.ipynb
├── master_dataset.ipynb
└── README.md
```

- `checkpoints/`: Directory containing Hugging Face model checkpoints and related files.
- `figs/`: Directory containing figures and visualizations generated by the notebooks.
- `main_analysis.ipynb`: Main analysis notebook for extracting and visualizing attention weights.
- `supplm-analysis.ipynb`: Notebook containing supplementary analysis on DHS peak data and disease biosamples
- External notebooks borrowed from https://github.com/pinellolab/DNA-Diffusion/blob/main/notebooks:
  - `master_dataset.ipynb`: Notebook for preprocessing DHS data
  - `filter_master.ipynb`: Notebook for filtering data based on cell-specific DHSs.
- `README.md`: The present file.

## Dependencies

The project requires the following dependencies:
- Python 3.7 or higher
- PyTorch
- Transformers (Hugging Face)
- Biopython
- Matplotlib
- Seaborn
- Pandas
- NumPy
- Scikit-learn
- TQDM
- WordCloud
- XGBoost
- Google Downloader

Install the dependencies using:
```bash
pip install torch transformers biopython matplotlib scikit-learn seaborn pandas numpy tqdm wordcloud xgboost gdown
```

## Setup Instructions

1. Clone the repository to your local machine.
2. Install the necessary dependencies as mentioned above.
3. Ensure you have Jupyter Notebook or Jupyter Lab installed to run the notebooks.

## Running the Notebooks

1. Navigate to the directory containing the cloned repository.
2. Launch Jupyter Notebook or Jupyter Lab:

```bash
jupyter notebook
```

3. Open the desired notebook (e.g., `main_analysis.ipynb`) and run the cells sequentially.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.
